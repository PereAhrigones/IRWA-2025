{% extends "base.html" %}
{% block page_title %}{{ page_title }}{% endblock %}
{% block content %}
    <div class="centered">
        <p>&nbsp;</p>
        <p>&nbsp;</p>
        <p>&nbsp;</p>
        <form class="d-flex" method="POST" onSubmit='return validate();' action="/search">
            <input class="search-text me-2" name="search-query" type="search" placeholder="Search" aria-label="Search"
                   autofocus="autofocus">
            <button class="btn btn-primary" type="submit" onclick='this.form.submit();'>Search</button>
            <input name="upf-irwa-hidden" type="hidden" value="123">
        </form>
        <div class="mt-3" style="text-align: center;">
            <label for="search-algorithm" style="font-weight: bold; margin-right: 10px;">Search Algorithm:</label>
            <select id="search-algorithm" name="search-algorithm" class="form-select" style="display: inline-block; width: auto; padding: 5px 10px;" onchange="saveAlgorithm(this.value)">
                <option value="custom" selected>Custom (APPG25)</option>
                <option value="search_tfidf">TF-IDF</option>
                <option value="search_bm25">BM25</option>
            </select>
        </div>
        <script>
            // Save selected algorithm to localStorage
            function saveAlgorithm(algo) {
                localStorage.setItem('searchAlgorithm', algo);
            }
            // Restore selected algorithm on page load
            window.addEventListener('DOMContentLoaded', function() {
                const saved = localStorage.getItem('searchAlgorithm');
                if (saved) {
                    document.getElementById('search-algorithm').value = saved;
                }
            });
            // Add algorithm to form on submit
            document.querySelector('form').addEventListener('submit', function() {
                const algo = document.getElementById('search-algorithm').value;
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'algorithm';
                input.value = algo;
                this.appendChild(input);
            });
        </script>
        <div class="row mt-5">
            <!-- Stats box -->
            <div class="col-md-6 mb-4">
                <div class="info-box">
                    <h4>Stats</h4>
                    <a href="/stats">
                        <img src="{{ url_for('static', filename='stats.jpg') }}" class="img-fluid box-image">
                    </a>
                </div>
            </div>

            <!-- Dashboard box -->
            <div class="col-md-6 mb-4">
                <div class="info-box">
                    <h4>Dashboard</h4>
                    <a href="/dashboard">
                        <img src="{{ url_for('static', filename='dashboard.png') }}" class="img-fluid box-image">
                    </a>
                </div>
            </div>
        </div>

        <p>&nbsp;</p>
        <p>&nbsp;</p>
        <p>&nbsp;</p>
    </div>
{% endblock %}
